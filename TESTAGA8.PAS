
PROGRAM TESTAGA8;

{ $APPTYPE CONSOLE}

uses liba;

// Test of AGA8-92DC method implemented in the unit liba
// This program was successfully compiled with Virtual Pascal version 2.1,
// Delphi 3.0, Delphi 7.3.4.3 and Lazarus 0.9.28.8
//
// Examples from ISO 12213-2, page 18, produce the following results:
//
//   P     T       1        2        3        4        5        6
//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
//  6.0  -3.15  0.84053  0.83348  0.79380  0.88550  0.82609  0.85380
//  6.0   6.85  0.86199  0.85596  0.82206  0.90144  0.84969  0.87370
//  6.0  16.85  0.88006  0.87484  0.84544  0.91501  0.86944  0.89052
//  6.0  36.85  0.90867  0.90466  0.88183  0.93674  0.90052  0.91723
//  6.0  56.85  0.93011  0.92696  0.90868  0.95318  0.92368  0.93730
// 12.0  -3.15  0.72133  0.71044  0.64145  0.81024  0.69540  0.75074
// 12.0   6.85  0.76025  0.75066  0.68971  0.83782  0.73780  0.78586
// 12.0  16.85  0.79317  0.78475  0.73123  0.86137  0.77369  0.81569
// 12.0  36.85  0.84515  0.83863  0.79697  0.89913  0.83022  0.86311
// 12.0  56.85  0.88383  0.87870  0.84553  0.92766  0.87211  0.89862
//

// Gas compositions for example calculations
const ex1:array[1..6] of aga=
((0.9650, 0.0030, 0.0060, 0.0180, 0.0045, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0010, 0.0010, 0.0005, 0.0003, 0.0007, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000),
 (0.9070, 0.0310, 0.0050, 0.0450, 0.0084, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0010, 0.0015, 0.0003, 0.0004, 0.0004, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000),
 (0.8590, 0.0100, 0.0150, 0.0850, 0.0230, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0035, 0.0035, 0.0005, 0.0005, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000),
 (0.7350, 0.1000, 0.0160, 0.0330, 0.0074, 0.0000, 0.0000, 0.0950, 0.0100, 0.0000, 0.0012, 0.0012, 0.0004, 0.0004, 0.0002, 0.0001, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000),
 (0.8120, 0.0570, 0.0760, 0.0430, 0.0090, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0015, 0.0015, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000),
 (0.8260, 0.1170, 0.0110, 0.0350, 0.0075, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0012, 0.0012, 0.0004, 0.0004, 0.0002, 0.0001, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000));

// Temperatures for example calculations
const t:array[1..5] of double = (-3.15,6.85,16.85,36.85,56.85);

// Pressures for example calculations
const p:array[1..2] of double = (6,12);


var TT,D,Z,BMIX:double; i,j,k: integer;


begin

 writeln;
 writeln('    P      T       1        2        3        4        5        6 ');
 writeln(' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~');

 for i:=1 to 2 do begin
  for j:=1 to 5 do begin
   write(p[i]:6:2,t[j]:7:2);
   for k:=1 to 6 do begin
    DCAGA(ex1[k]); TT:=T[j]+273.15;
    DZOFPT(P[i], TT, D, Z, BMIX);
    write(z:9:5);
   end;
   writeln
  end;
 end;

 readln;

end.

